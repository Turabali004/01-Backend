!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b6054384-f900-4c38-8abb-e77b4dabac80",e._sentryDebugIdIdentifier="sentry-dbid-b6054384-f900-4c38-8abb-e77b4dabac80")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9962],{32471:function(e,t,n){n.d(t,{_:function(){return r}}),n(2935),n(41866),n(26873);var r="_1c6tscn1 _1286nb120o _1286nb11m0 _1286nb11b6 _1286nb11pu _1286nb13ac _1286nb13ho"},24418:function(e,t,n){n.d(t,{M:function(){return o}});var r=n(52983),a=n(65059);let i=async(e,t,n)=>{await fetch("/api/ai/log-action",{method:"POST",body:JSON.stringify({action:n,uuid:e,resourceId:t})})},o=()=>{let{id:e}=(0,a.ph)();return(0,r.useCallback)(async(t,n)=>{await i(t,e,n)},[e])}},51900:function(e,t,n){n.d(t,{QC:function(){return i},Qf:function(){return o},Z:function(){return c},_R:function(){return r},vy:function(){return l},wj:function(){return a}});let r=2e3,a=15,i="PNG",o=3,l=5,c=3},69535:function(e,t,n){n.d(t,{Qc:function(){return r.Q},pV:function(){return l},A8:function(){return M},CA:function(){return N}});var r=n(38384),a=n(52983),i=n(51900);let o=async(e,t)=>{if(!e)return;let n=await fetch("/api/ai/remove-background-check?uuid=".concat(e).concat(t?"&isLastCall=1":""));if(200!==n.status)return null;let{image_url:r}=await n.json();return r},l=()=>{let e=(0,a.useRef)(0),t=(0,a.useRef)();return{pollingBackgroundImageUrl:(0,a.useCallback)(n=>new Promise((r,a)=>{t.current=setInterval(async()=>{if(e.current>=i.wj){a(Error("Failed to remove background"));return}e.current+=1;let t=e.current===i.wj,l=await o(n,t);l&&r(l)},i._R)}).finally(()=>{e.current=0,clearInterval(t.current)}),[])}};var c=n(62168),u=n(84160),s=n(21567),d=n(59398),f=n(45123),g=n(72833),w=n(85043),b=n(83053);let m=()=>{let{setForceRemoveBackgroundButtonTooltip:e,setIsRemoveBackgroundLoading:t}=(0,s.ql)(),n=(0,w.J)(),r=(0,g.L)(),i=(0,f._)(),o=(0,d.E)();return(0,a.useCallback)(async a=>{let l=(0,b.L)(),c=await fetch("/api/ai/remove-background",{method:"POST",body:JSON.stringify({resourceId:a,uuid:l,walletId:r,creditsTransaction:!!(i||r)})});if(429===c.status)return e(!0),t(!1),await n(),null;if(!c.ok)throw Error("Failed to remove background");if(200===c.status){let{transactionId:e,walletId:t}=await c.json();return r||o(t),{uuid:l,transactionId:e}}return{uuid:l}},[o,i,e,t,r,n])};var h=n(17417),y=n(32748);let p=()=>{let{openToast:e}=(0,h.x_)(),{t}=(0,y.$G)("detail"),{setIsRemoveBackgroundLoading:n}=(0,s.ql)();return(0,a.useCallback)(()=>{e({type:"danger",title:t("removeBackground.errorTitle"),message:t("removeBackground.errorMessage"),duration:3e3}),n(!1)},[e,t,n])};var v=n(20256),k=n(85618);let C=(e,t)=>{let n=new Image;n.onload=function(){let e=document.createElement("canvas"),r=e.getContext("2d");if(e.width=n.width,e.height=n.height,!r){t(!1);return}r.drawImage(n,0,0);let a=r.getImageData(0,0,e.width,e.height).data;for(let e=0;e<a.length;e+=4)if(0!==a[e+3]){t(!0);return}t(!1)},n.src=e};var _=n(43815),I=n(65508);let R=()=>(0,a.useCallback)(()=>{(0,I.loadSpace)("bb6a004a-8f03-4d2a-88fb-a63499d4591a").then(e=>{e.init(),e.logEvent("remove_bg")})},[]);var L=n(7616),O=n(27288);let P=()=>{let{id:e}=(0,u.ph)(),{setIsRemoveBackgroundLoading:t}=(0,s.ql)(),n=(0,L.b9)((0,O.u)(e)),{setImagePreviewMode:r}=(0,s.TV)();return(0,a.useCallback)(e=>{let{imageWithoutBackgroundBase64:a,imageWithoutBackgroundUrl:i,uuid:o}=null!=e?e:{};t(!1),r("transparent"),a&&o&&i&&n({url:a,uuid:o,externalUrl:i})},[r,t,n])},j=()=>{let e=p(),t=P(),{id:n,premium:r,regularType:i}=(0,u.ph)(),o=(0,v.mS)(),l=R();return(0,a.useCallback)(async(a,c)=>{try{let u=await (0,_.C)(a);C(u,s=>{if(!s){e();return}t({imageWithoutBackgroundUrl:a,imageWithoutBackgroundBase64:u,uuid:c}),o({resourceId:n,isResourcePremium:r,resourceType:i,downloadType:k.os}),l()})}catch(t){e()}},[t,o,n,r,i,l,e])},U=()=>{let e=(0,a.useRef)(0),t=(0,a.useRef)(null),n=j(),r=p(),l=(0,w.J)();return(0,a.useCallback)(a=>{t.current=setInterval(async()=>{if(e.current>=i.wj){t.current&&clearInterval(t.current),r();return}e.current+=1;let c=e.current===i.wj,u=await o(a,c);u&&(n(u,a),await l(),t.current&&clearInterval(t.current))},i._R)},[n,r,l])},x=()=>{let{id:e,premium:t,regularType:n,url:r}=(0,u.ph)(),{setIsRemoveBackgroundLoading:i}=(0,s.ql)(),o=p(),l=U(),d=(0,c.PN)(),f=m(),g=(0,a.useCallback)(()=>d({event:"ga4event",event_name:"background_remove",category:n,file_id:e,license:t?"premium":"free",location:"resource_detail",url_link:r}),[e,t,n,r,d]);return(0,a.useCallback)(async()=>{try{g();let t=await f(e);if(!t){i(!1);return}let{uuid:n}=t;l(n)}catch(e){o()}},[i,g,f,e,l,o])};var E=n(42957),S=n(78683),T=n(55662),A=n(24418);let M=()=>{let{id:e,name:t,author:n,premium:o,regularType:l,isAIGenerated:c,dimensions:{width:s=0,height:d=0}={}}=(0,u.ph)(),{downloadCopyImageToClipboard:f}=(0,S.t)(),{url:g,uuid:w}=(0,r.Q)(),b=(0,A.M)(),m=(0,T.m)(),h=(0,E.TH)({file_extension:i.QC.toLowerCase(),file_name:t,file_id:e,license:o?"premium":"free",resolution:"original",style:"na",author_name:n.name,category:c?"ai_image":l,action:"copy",location:"resource_detail"});return(0,a.useCallback)(()=>{f({url:g,width:s,height:d}),h(),m({resourceId:e,isResourcePremium:o,resourceType:l,downloadType:k.PF}),b(w,k.PF)},[f,d,e,g,b,o,l,h,m,w,s])};var V=n(83741),B=n(86806),W=n(53294);let H=()=>{var e;let{fileTypes:t,name:n,author:r,premium:i,regularType:o,isAIGenerated:l,url:c,id:u}=(0,B.p)(),s=P(),d=x(),{handleDownload:f}=(0,V.i)({resource:{id:u,name:n,author:r,premium:i,regularType:o,isAIGenerated:l,url:c},option:null==t?void 0:null===(e=t.png)||void 0===e?void 0:e.items[0].id,file:"png",showAttributionModal:!1,action:"ai_tool_removebg"}),{setIsRemoveBackgroundLoading:g}=(0,W.q)(),w=(0,a.useCallback)(async(e,t)=>{let n=window.URL.createObjectURL(t);s({imageWithoutBackgroundUrl:e,imageWithoutBackgroundBase64:await (0,_.C)(n),uuid:(0,b.L)()}),window.URL.revokeObjectURL(n)},[s]),m=(0,a.useCallback)(async e=>{let t=document.createElement("canvas"),n=e.naturalWidth,r=e.naturalHeight;t.width=n,t.height=r;let a=t.getContext("2d");if(!a){await d();return}a.drawImage(e,0,0,n,r),t.toBlob(async t=>{if(!t){await d();return}await w(e.src,t)},"image/png",1)},[w,d]);return(0,a.useCallback)(async()=>{let e=await f();if(!e){await d();return}let t=new Image;t.src=e.url,t.crossOrigin="Anonymous",t.onload=async()=>{await m(t),g(!1)},t.onerror=async()=>{await d()}},[f,m,d,g])},N=()=>{let e=x(),{hideAttribution:t,fileTypes:n}=(0,u.ph)(),{setRemoveBackgroundAnimationEnd:i,setIsRemoveBackgroundLoading:o}=(0,s.ql)(),l=H(),{setImageModeToOriginal:c}=(0,s.TV)(),{url:d}=(0,r.Q)(),f=P();return(0,a.useCallback)(async()=>{if(i(!1),o(!0),t(),c(),d){f();return}if(null==n?void 0:n.png){await l();return}await e()},[i,t,o,c,d,n,e,f,l])}},43815:function(e,t,n){n.d(t,{C:function(){return r}});let r=e=>fetch(e).then(e=>e.blob()).then(e=>new Promise(t=>{let n=new FileReader;n.onload=function(){t(this.result)},n.readAsDataURL(e)}))},78683:function(e,t,n){n.d(t,{t:function(){return d}});var r=n(59190),a=n(59813),i=n(14409),o=n(17417),l=n(32748),c=n(52983),u=n(7489);let s=(e,t)=>{let n=document.createElement("a");t&&(n.download=t),n.href=e,n.click(),setTimeout(function(){n.remove()},200)},d=()=>{let{t:e}=(0,l.$G)(["detail","common"]),[t,n]=(0,c.useState)(!1),{openToast:d}=(0,o.x_)(),{setConfirm:f}=(0,u.N)(),g=(0,c.useCallback)(async t=>{try{(0,i.C)()||d({type:"danger",message:e("clipboardNotSupported")}),n(!0),await navigator.clipboard.write([t]),d({type:"success",title:e("detail:copyImageClipboard"),message:e("common:copiedsuccessfully"),testId:"notification-copied-successfully"})}catch(e){d()}finally{n(!1)}},[d,e]),w=(0,c.useCallback)(async(e,t,n,i,o,l)=>{let c="clipboard"===i,u=c?e.naturalWidth:t,d=c?e.naturalHeight:n,w=document.createElement("canvas");w.width=u,w.height=d;let b=w.getContext("2d");b&&(b.drawImage(e,0,0,u,d),w.toBlob(async e=>{let t;if(e){if(c){if((0,a.gn)()||r.G6){t=new ClipboardItem({[e.type]:Promise.resolve(e)}),f(()=>{g(t)});return}g(t=new ClipboardItem({[e.type]:e}))}else{let t=window.URL.createObjectURL(e);s(t,l),window.URL.revokeObjectURL(t)}}},"image/".concat(o),1))},[g,f]);return{downloadImageSize:(0,c.useCallback)(async e=>{let{url:t,filename:n,width:r,height:a}=e;try{let e=new Image;e.src=t,e.crossOrigin="Anonymous",e.onload=()=>{w(e,r,a,"download","jpeg",n)},e.onerror=()=>d()}catch(e){d()}},[w,d]),downloadCopyImageToClipboard:(0,c.useCallback)(async e=>{let{url:t,width:r,height:a}=e;try{n(!0);let e=new Image;e.src=t,e.crossOrigin="Anonymous",e.onload=()=>{w(e,r,a,"clipboard","png")},e.onerror=()=>{n(!1),d()}}catch(e){n(!1),d()}},[d,w]),isCopying:t}}},94979:function(e,t,n){var r=n(97458);t.Z=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 14 14","aria-hidden":!0,...e,children:(0,r.jsx)("path",{d:"M11.43 1.066H7.684L7.682.684a.683.683 0 1 0-1.367 0l.001.382H2.57c-.829 0-1.504.675-1.504 1.504v8.86c0 .829.675 1.504 1.504 1.504h3.746v.382a.684.684 0 1 0 1.368 0v-.382h3.746c.829 0 1.504-.675 1.504-1.504V2.57c0-.829-.675-1.504-1.504-1.504m-8.86 10.5a.137.137 0 0 1-.136-.136V9.27h2.27V7h-2.27V4.703h2.27v-2.27h1.612V4.73H4.73V7h1.586v2.297H4.73v2.27zm8.996-.136a.137.137 0 0 1-.136.136H7.684V2.434h3.746c.075 0 .136.06.136.136z"})})},11486:function(e,t,n){n.d(t,{p:function(){return r}});let r="https://fps.cdnpk.net"},59813:function(e,t,n){n.d(t,{gn:function(){return o},eE:function(){return i},Xe:function(){return l}});let r=()=>{if("undefined"==typeof navigator)return"Unknown";let e=navigator.userAgent,t=navigator.platform,n={MacOS:["Macintosh","MacIntel","MacPPC","Mac68K"].includes(t),iOS:["iPhone","iPad","iPod"].includes(t),Windows:["Win32","Win64","Windows","WinCE"].includes(t),Android:/Android/.test(e),Linux:/Linux/.test(t),Unknown:!0};return Object.keys(n).find(e=>n[e])||"Unknown"},a=r(),i=()=>"MacOS"===a,o=()=>"iOS"===a,l=()=>o()||"Android"===r()}}]);